<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Таблица оценок</title>
  <style>
    html, body { height: 100%; margin: 0; }
    .wrap { height: 100%; display: flex; flex-direction: column; }
    .bar {
      padding: 10px 12px;
      font: 14px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      border-bottom: 1px solid #e5e7eb;
      background: #ffffff;
    }
    .bar b { font-weight: 600; }
    .hint { color: #6b7280; margin-top: 4px; font-size: 12px; }
    iframe { flex: 1; width: 100%; border: 0; }
    .fallback {
      display: none;
      padding: 14px;
      font: 14px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: #fff;
      border-top: 1px solid #e5e7eb;
    }
    .fallback a { color: #2563eb; text-decoration: none; }
    .fallback a:hover { text-decoration: underline; }
    .pill {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 999px;
      background: #f3f4f6;
      font-size: 12px;
      margin-left: 8px;
      color: #374151;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="bar">
      <b>Оценки</b><span class="pill">Google Sheets</span>
      <div class="hint">
        Если таблица не отображается, значит она не “Опубликована в интернете” (File → Publish to the web).
      </div>
    </div>

    <!--
      ВАЖНО:
      Для встраивания нужен режим публикации.
      Эта ссылка начинает работать после: Файл → Опубликовать в интернете → Веб-страница.
    -->
    <iframe
      id="sheetFrame"
      src="https://docs.google.com/spreadsheets/d/1slhAN9u0Wiu1bkC3fwVbMjVb8jYa29tEdMpcClF4nB8/pubhtml?widget=true&amp;headers=false"
      loading="lazy"
      referrerpolicy="no-referrer"
    ></iframe>

    <div class="fallback" id="fallback">
      Таблица не открылась внутри страницы (обычно так бывает, если Google не разрешил встраивание или таблица не опубликована).
      <br><br>
      Откройте таблицу по ссылке:
      <a href="https://docs.google.com/spreadsheets/d/1slhAN9u0Wiu1bkC3fwVbMjVb8jYa29tEdMpcClF4nB8/edit?usp=sharing" target="_blank" rel="noreferrer">
        открыть Google Sheet
      </a>
    </div>
  </div>

  <script>
    // Если iframe не загрузился/пустой (часто из-за ограничений Google), покажем запасной вариант.
    const frame = document.getElementById('sheetFrame');
    const fallback = document.getElementById('fallback');

    let shown = false;
    function showFallback() {
      if (shown) return;
      shown = true;
      fallback.style.display = 'block';
    }

    // Если через ~6 секунд внутри iframe ничего не отрисовалось — показываем fallback.
    setTimeout(() => {
      try {
        // Доступ к содержимому iframe может быть ограничен (CORS), поэтому проверка “мягкая”.
        // Просто показываем fallback, если iframe выглядит как “не загрузился”.
        if (!frame || frame.clientHeight < 200) showFallback();
      } catch (e) {
        showFallback();
      }
    }, 6000);

    frame.addEventListener('error', showFallback);
  </script>
</body>
</html>
